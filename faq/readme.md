# 常见问题

## 访问realvnc提示验证失败？

1. 把密码类型修改为VNC
2. 把加密类型修改为 Prefer On

## 连接rdp协议的windows7或者windows server 2008直接断开？

因为freerdp的一个问题导致的，把 设置>RDP 下面的禁用字形缓存打开即可。
详情可参考 https://issues.apache.org/jira/browse/GUACAMOLE-1191

## ssh协议中文字体乱码怎么办？

新版docker容器中已经内置了中文字体，如果是原生安装的，请自行安装中文字体。

## ssh协议类型的资产连接模式有什么区别？

1. 默认：默认使用guacd模式，但某些密钥不支持。
2. 原生：使用golang+xterm.js方式实现的webssh，传输协议是文本，操作响应更快。但目前尚未实现实时监控。

## 系统密码忘记了怎么办？

首先需要进入程序所在目录，使用docker安装的程序目录为：/usr/local/next-terminal

执行命令 

```shell
./next-terminal --reset-password admin
```

其中 admin 为用户登录账号，成功之后会输出 

``` shell

 _______                   __    ___________                  .__              .__   
 \      \   ____ ___  ____/  |_  \__    ___/__________  _____ |__| ____ _____  |  |  
 /   |   \_/ __ \\  \/  /\   __\   |    |_/ __ \_  __ \/     \|  |/    \\__  \ |  |  
/    |    \  ___/ >    <  |  |     |    |\  ___/|  | \/  Y Y  \  |   |  \/ __ \|  |__
\____|__  /\___  >__/\_ \ |__|     |____| \___  >__|  |__|_|  /__|___|  (____  /____/
        \/     \/      \/                     \/            \/        \/     \/      v0.3.0

当前数据库模式为：mysql
Mar  5 20:00:16.923 [DEBU] 用户「admin」密码初始化为: next-terminal

```

## TOTP客户端丢了怎么办？

首先需要进入程序所在目录，使用docker安装的程序目录为：/usr/local/next-terminal

执行命令

```shell
./next-terminal --reset-totp admin
```

其中 admin 为用户登录账号，成功之后会输出

``` shell

 _______                   __    ___________                  .__              .__   
 \      \   ____ ___  ____/  |_  \__    ___/__________  _____ |__| ____ _____  |  |  
 /   |   \_/ __ \\  \/  /\   __\   |    |_/ __ \_  __ \/     \|  |/    \\__  \ |  |  
/    |    \  ___/ >    <  |  |     |    |\  ___/|  | \/  Y Y  \  |   |  \/ __ \|  |__
\____|__  /\___  >__/\_ \ |__|     |____| \___  >__|  |__|_|  /__|___|  (____  /____/
        \/     \/      \/                     \/            \/        \/     \/      v0.4.0

当前数据库模式为：mysql
Mar  5 20:00:16.923 [DEBU] 用户「admin」已重置TOTP

```

## 想要修改数据库敏感信息加密的key怎么办？

首先需要进入程序所在目录，使用docker安装的程序目录为：/usr/local/next-terminal

执行命令

```shell
./next-terminal --encryption-key 旧的加密key --new-encryption-key 新的的加密key
```

成功之后会输出

``` shell

 _______                   __    ___________                  .__              .__   
 \      \   ____ ___  ____/  |_  \__    ___/__________  _____ |__| ____ _____  |  |  
 /   |   \_/ __ \\  \/  /\   __\   |    |_/ __ \_  __ \/     \|  |/    \\__  \ |  |  
/    |    \  ___/ >    <  |  |     |    |\  ___/|  | \/  Y Y  \  |   |  \/ __ \|  |__
\____|__  /\___  >__/\_ \ |__|     |____| \___  >__|  |__|_|  /__|___|  (____  /____/
        \/     \/      \/                     \/            \/        \/     \/      v0.4.0

当前数据库模式为：mysql
Mar  5 20:00:16.923 [DEBU] encryption key has being changed.

```

最后重新启动程序，并且把加密key修改为新的。

## 使用 SSH RSA 证书无法登录，提示 ssh: no key found

PuTTY 生成的密钥无法直接使用，需要导出后再使用。

## 原生安装如何升级？

下载打包后的压缩文件，替换其中的 next-terminal 文件即可。

## 资产状态检测原理是什么？

tcp连接到目标IP和端口进行测试的，默认超时时间是3秒，在计划任务中每隔一个小时检测一次。如果资产状态检测为不在线，可以自行登录next-terminal所在服务器使用telnet进行测试。

## 如何从 0.5.0 升级？

- docker容器升级
  1. 删除掉旧的容器
  2. 按照新的docker安装方式进行安装
  3. 移动录屏文件到新的录屏文件目录（默认在 data/recording 目录下）
   
- 原生安装升级
  1. 下载最新的二进制文件并解压
  2. 替换 next-terminal 文件
  3. 替换配置文件 config.yml 并修改对应的配置